


ALTER TABLE etiqueta ALTER COLUMN eti_id SET DEFAULT nextval('id_etiquetas');

/*Inserts*/
insert into usuario values (1,'usuario1','usuario1','token',true,'usuario1','');
insert into usuario values (2,'usuario2','usuario2','token2',false,'usuario2','');
insert into usuario values (3,'usuario3','usuario3','token3',false,'usuario3','');

insert into video values (1,'prueba 1','descrip 1','','https1','10-11-2017',1,2);
insert into video values (2,'prueba 2','descrip 2','','https2','10-11-2017',2,2);
insert into video values (3,'prueba 3','descrip 3','','https3','10-11-2017',3,2);
insert into video values (5,'hola','dasd','','https3','10-11-2017',5,2);
insert into video values (6,'como esta hola','asd','','https3','10-11-2017',6,2);
insert into video values (7,'armas de fuego','asd','','https3','10-11-2017',5,2);



insert into categoria values (1,'comedia');
insert into categoria values (2,'suspenso');
insert into categoria values (3,'romantico');
insert into categoria values (4,'ciencia ficcion');
insert into categoria values (5,'armas');
insert into categoria values (6,'tutoriales');

--Video con categoria
insert into video_cat values (1,1);
insert into video_cat values (3,4);
insert into video_cat values (2,6);
insert into video_cat values (5,2);
insert into video_cat values (6,5);
insert into video_cat values (7,5);



--Usuario con categoria
insert into preferencia values (1,1);
insert into preferencia values (1,2);
insert into preferencia values (2,6);

--Usuario con usuario (SUSCRIPCION)
insert into suscripcion values (1,2);


-- BUSQUEDAAAS
(AVANZADA)
select  video.*,categoria.cat_valor
from video, categoria, video_cat
where video.vid_titulo like '%hola%'  and video.vid_id=video_cat.idvid and categoria.cat_id=video_cat.idcat  

union

select video.*,categoria.cat_valor
from video,categoria,video_cat
where categoria.cat_valor like '%armas%'  and video.vid_id=video_cat.idvid and categoria.cat_id=video_cat.idcat

union
select video.*, etiqueta.eti_valor
from video,etiqueta,video_etiq
where etiqueta.eti_valor like '%#%'  AND video.vid_id=video_etiq.idvid AND etiqueta.eti_id=video_etiq.idetiq;




(busca por nombre de video)

select  video.*
from video, categoria, video_cat
where video.vid_titulo like '%hola%'  and video.vid_id=video_cat.idvid and categoria.cat_id=video_cat.idcat 

(busca por categoria)
select video.*
from video,categoria,video_cat
where categoria.cat_valor like '%armas%'  and video.vid_id=video_cat.idvid and categoria.cat_id=video_cat.idcat 

(busqueda por etiquetas)
select video.*, etiqueta.eti_valor
from video,etiqueta,video_etiq
where etiqueta.eti_valor like '%#%'  AND video.vid_id=video_etiq.idvid AND etiqueta.eti_id=video_etiq.idetiq;

--SUSCRITOS
SELECT distinct video.*
FROM video,usuario,suscripcion
WHERE video.vid_usuario=suscripcion.id_suscripcion and suscripcion.id_suscriptor=1
ORDER BY video.vid_fecha desc 

--MAS VISTOS
SELECT * 
FROM VIDEO
ORDER BY VIDEO.VID_VISITAS DESC

--PREFERENCIAS

SELECT video.vid_titulo,video.vid_descripcion,video.vid_imagen,video.vid_url,video.vid_fecha,video.vid_visitas ,video.vid_usuario
		 FROM video,usuario,categoria,preferencia,video_cat
         WHERE video.vid_id=video_cat.idvid and categoria.cat_id=video_cat.idcat
         AND   usuario.usu_id=preferencia.id_usu and categoria.cat_id=preferencia.id_cat
         AND  video_cat.idcat=preferencia.id_cat and usuario.usu_id=1


                     